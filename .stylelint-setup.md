# Stylelint Setup Summary

## What Was Added

### 1. Dependencies
- `stylelint` - Core linter
- `stylelint-config-standard-scss` - Standard SCSS configuration
- `stylelint-scss` - SCSS-specific rules plugin
- `postcss` - Required peer dependency

### 2. Configuration Files
- `.stylelintrc.json` - Main configuration with rules to enforce variable usage
- `.stylelintignore` - Files/directories to ignore during linting

### 3. NPM Scripts
- `lint:css` - Lint all CSS/SCSS files
- `lint:css:fix` - Lint and auto-fix CSS/SCSS files
- `lint` - Updated to include stylelint (runs TypeScript, ESLint, and Stylelint)

### 4. CI Integration
- Updated `.github/workflows/lint.yml` to run stylelint as part of CI

## Configuration Overview

### Enforced Rules

**Primary Goal: Color Variable Enforcement**
- `color-no-hex`: **Enforced** - Prevents direct use of hex colors (e.g., `#3F6DCA`)
- `color-named`: **Enforced** - Prevents use of named colors (e.g., `red`, `blue`, `white`)

All colors must use CSS custom properties (`var(--ux-*)`) or SCSS variables.

**Other Active Rules:**
- `scss/at-rule-no-unknown`: Validates SCSS at-rules
- `scss/dollar-variable-colon-space-after`: Enforces space after colon in variables
- `scss/dollar-variable-colon-space-before`: Enforces no space before colon in variables
- `scss/operator-no-unspaced`: Requires spaces around operators
- `function-no-unknown`: Validates function names (allows `var`, `darken`, `lighten`)

### Disabled Standard Rules

To accommodate existing code patterns, the following rules from `stylelint-config-standard-scss` are **disabled**:

**Selector & Naming:**
- `selector-class-pattern` - Allows various naming conventions (PascalCase, camelCase, kebab-case, BEM, CSS Modules)
- `scss/at-mixin-pattern` - Allows existing mixin naming patterns

**Code Quality:**
- `no-descending-specificity` - CSS specificity order not enforced
- `no-duplicate-selectors` - Duplicate selectors allowed
- `declaration-block-no-duplicate-properties` - Duplicate properties allowed
- `declaration-block-no-shorthand-property-overrides` - Shorthand overrides allowed
- `declaration-block-no-redundant-longhand-properties` - Longhand properties allowed

**Property & Value Validation:**
- `property-no-unknown` - Allows unknown properties (for CSS Modules `:export`)
- `property-no-deprecated` - Allows deprecated properties (e.g., `clip`)
- `declaration-property-value-no-unknown` - Allows unknown values
- `selector-pseudo-class-no-unknown` - Allows unknown pseudo-classes (for CSS Modules `:global`)

**Formatting & Precision:**
- `number-max-precision` - No precision limit
- `block-no-empty` - Empty blocks allowed

**SCSS Specific:**
- `scss/no-global-function-names` - Legacy SCSS functions allowed (`darken()`, `lighten()`)
- `scss/comment-no-empty` - Empty comments allowed
- `comment-no-empty` - Empty comments allowed

### Color Definition Files Exemption

Files that define color variables are exempt from `color-no-hex`:
- `scss/css_properties.scss`
- `scss/colors/**/*.scss`

## Usage

### Lint all stylesheets
```bash
yarn lint:css
```

### Auto-fix issues (where possible)
```bash
yarn lint:css:fix
```

### Run all linting (JS + CSS)
```bash
yarn lint
```

## Examples

### Using Color Variables

❌ **Bad** - Hardcoded hex colors:
```scss
.my-component {
  color: #3F6DCA;
  background-color: #FFFFFF;
  border-color: #E03131;
}
```

✅ **Good** - Using CSS custom properties:
```scss
.my-component {
  color: var(--ux-blue);
  background-color: var(--ux-white);
  border-color: var(--ux-red);
}
```

✅ **Also Good** - Using SCSS variables (from `scss/colors/palette.scss`):
```scss
.my-component {
  color: $ux-blue;
  background-color: $ux-white;
  border-color: $ux-red;
}
```

### Available Colors

See `scss/css_properties.scss` for the complete list of available color variables, including:
- Base colors: `--ux-blue`, `--ux-red`, `--ux-emerald`, `--ux-gray`, etc.
- Color scales: `--ux-blue-100` through `--ux-blue-900`
- Brand colors: `--brand-color-facebook`, `--brand-color-google`, etc.
- Synthesis palette: `--synth-*` variables

## Guidelines for New Code

When writing new styles:

1. **Always use color variables** - Use `var(--ux-*)` CSS custom properties or SCSS variables instead of hardcoded hex values or named colors
2. **Reference the color palette** - See `scss/css_properties.scss` for all available color variables
3. **Run linting locally** - Use `yarn lint:css` before committing to catch violations early
4. **Auto-fix when possible** - Use `yarn lint:css:fix` to automatically fix formatting issues

## Maintenance

- **CI Integration**: Stylelint runs as part of the CI pipeline via `.github/workflows/lint.yml`
- **Existing Code**: Many standard rules are disabled to accommodate legacy patterns - focus is on enforcing color variable usage going forward
- **Iterative Improvement**: As code is refactored, consider addressing disabled rules on a case-by-case basis

